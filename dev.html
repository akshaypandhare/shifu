Aplach code ahe second version
